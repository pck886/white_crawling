FROM bigchaindb/bigchaindb

RUN mkdir -p /data/.ci

COPY . /data/.ci

ARG backend
ARG abci_status

ENV BIGCHAINDB_DATABASE_PORT 27017
ENV BIGCHAINDB_DATABASE_BACKEND $backend
ENV BIGCHAINDB_SERVER_BIND 0.0.0.0:9984
ENV BIGCHAINDB_WSSERVER_HOST 0.0.0.0
ENV BIGCHAINDB_WSSERVER_SCHEME ws

ENV BIGCHAINDB_WSSERVER_ADVERTISED_HOST 0.0.0.0
ENV BIGCHAINDB_WSSERVER_ADVERTISED_SCHEME ws

ENV BIGCHAINDB_TENDERMINT_PORT 46657

ENV BIGCHAINDB_CI_ABCI ${abci_status}

RUN bigchaindb -y configure "$backend"